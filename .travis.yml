language: node_js
node_js:
- '0.10'
branches:
  only:
  - master
before_script:
- npm install -g grunt-cli
- npm install -g casperjs
script:
- set -e
- grunt
- node server.js &
- npm test
- git config --global user.email $GH_EMAIL
- git config --global user.name $GH_USERNAME
- git remote add deploy https://${GH_TOKEN}@github.com/${GH_USERNAME}/thedebate.git > /dev/null 2>&1
- git checkout -b staging > /dev/null 2>&1
- git merge master > /dev/null 2>&1
- git push deploy staging > /dev/null 2>&1
- set +e
env:
  global:
  - secure: ZMH9Q31OAh0hAjMOn1pT63S1eBPWtNoXm3l3sFa3STFdpN7x61OgTYESM8egQ7j+2Wlf3ht31ZFUmPsUktA4hRql0oaNY0w0LMtmDz/XsuEfW3m+SJte2tiCoDhnNwOQJDRKb511MxsRjx9YVT9ALTJJA7+LiZE+KfS4oNNFiE4=
  - secure: oqoyDH96P8FRh83Kb837N5wHM5PI8WCWP9GYUqjs+rPc4uSyFdQNp8c61/n/fWD1mT49yL4Q8CCgHJm3iSWBTRVBzUlsfQDEkBmwtBBvLB7bruX7Pfkxl0HKz3ILQ4OLVooyHIcu055TVhT6Ld2TsReQCsEJmZUq7XyiWRCCFoo=
  - secure: PZdgCC3sENfnitxQ8DaX+mJMNP0j9uWTY/cbjiB2Cgo5cDXYhXxc3XDLcd5pkoqdV4BcclvcPNY40OihfBEauyp9mm2QACi0MzrBCATldtVzoBJXYapsFX7hwQw6AY9og52sXglrgqT+4hXqb0phsOjTvpqfaL4slAb+8wSmoPk=
