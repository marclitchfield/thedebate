language: node_js
node_js:
- '0.10'
branches:
  only:
    - master
before_script:
- npm install -g casperjs
- node server.js &
script:
- npm test
- git config --global user.email $GH_EMAIL
- git config --global user.name $GH_USERNAME
- git remote add deploy https://${GH_TOKEN}@github.com/${GH_USERNAME}/thedebate.git > /dev/null 2>&1
- git checkout -b staging > /dev/null 2>&1
- git merge master > /dev/null 2>&1
- git push deploy staging > /dev/null 2>&1
env:
  global:
  - secure: GlV88Bq3MO4H/h+B7Yw7HISau4WQE7Din3CB2bd9+1oROkrrzHLRz9/c4pgRQi+XqOR467m7uG86KwO7NDu14rkIIKmNZLlt4lp1C9sUzxTIJMfAFSWXL89ZIuQbaNPiEsgqtmTNRgPsp336ppnkVv/ZwOEZPxZyqf1ogqSRPtY=
  - secure: MCx7nLGVpnXAzof1DxTWFxzWzF/0v/xGAiw63dx2GQRSodUyJBLFL+V5Mi1RB29+MXubIZLJ9VsfbQSAy7cgFKQH5Pa0B24kamx5kc34bCuTZsh0WhJ+1u8bJ6GdbGgHpKN+b2kerevguYoQHa45Fow/lhdzbgVQE12EZKIAkS0=
  - secure: eBamwqVviKvIkWZR+hs4XP08EPQe8AGLkkHG6TFd8cXNwSyw83NgUM0pb6/EOGXYPGoxvC8RAbnR2v5GrF+GV1jBaevEhxxGhdTtpqn8n0t1kxvZHhQaL5yD7VCcTAqrqmk6yckjuCi+OJ8IkdP5CLJa4U+DARIR6mUzTBA3NtE=
